function getDataLinks(t){console.log(t.length);for(var r="none",a=0;a<t.length;a++){console.log("hier");for(var e=0;e<t[a].length;e++)if(console.log("hier"),t[a][e].hasOwnProperty("operator")){var n=t[a][e].operator;console.log("hier"),"false"!=(r=getNeighbourOperator(n,"forward"))?(t[a][e].source=n,t[a][e].target=r,dataWithSourceAndTarget.push(t[a][e])):(t[a][e].source=n,t[a][e].target="none",dataWithSourceAndTarget.push(t[a][e]))}}console.log(dataWithSourceAndTarget.length);for(var a=0;a<dataWithSourceAndTarget.length;a++)console.log(dataWithSourceAndTarget[a])}function get_Data(t){var r=null;if(t instanceof Array)for(var a=0;a<t.length;a++)r=get_Data(t[a]);else for(var e in t){if("children"==e&&(outputOfEachOperators.push(t[e]),1==t[e]))return t;(t[e]instanceof Object||t[e]instanceof Array)&&(r=get_Data(t[e]))}return r}var nameOfOperatorToSearch,dataWithSourceAndTarget=[],outputOfEachOperators=[];$(document).ready((function(){function r(){h.attr("transform",d3.event.transform)}var a=20,e=90,n=30,o=90,d=960-o-e,i=$(document).height()-a-n,s=d3.scaleLinear().domain([0,1]).range(["red","green"]),l=d3.scaleLinear().domain([1,80]).range([1,10]),c=d3.zoom().scaleExtent([.1,3]).on("zoom",r),h=d3.select(".vs-graph").append("svg").attr("width",d+e+o).attr("height",i+a+n+300).attr("class","vs-svg-for-directed-graph").append("g").attr("transform","translate("+o+","+a+")").call(c),p=0,u=750,f,m=d3.tip().attr("class","d3-tip").offset([-10,0]).html((function(t){var r,a;(t.data.hasOwnProperty("name")&&(r="<strong>Operator Name:</strong> <span>"+t.data.name+"</span>"),t.data.hasOwnProperty("children"))?r+="<br /><strong>Number of processed data:</strong> <span>"+t.data.children.length+"</span>":(r+="<strong>Information about Node</strong>",t.data.hasOwnProperty("operator_number")&&(r+="<br /><strong>Operator Number:</strong> <span>"+t.data.operator_number+"</span>"),t.data.hasOwnProperty("operator")&&(r+="<br /><strong>Operator Name:</strong> <span>"+t.data.operator+"</span>"),t.data.hasOwnProperty("word")&&(r+="<br /><strong>Word:</strong> <span>"+t.data.word+"</span>"),t.data.hasOwnProperty("id")&&(r+="<br /><strong>ID:</strong> <span>"+t.data.id+"</span>"));return r.length>0?r:-1}));h.call(m);var g=d3.tree().size([i,d]);$.getJSON("data/data.json",(function(t){get_Data(t),getDataLinks(outputOfEachOperators)})),d3.json("data/data.json",(function(r,a){function e(t){t.children&&(t._children=t.children,t._children.forEach(e),t.children=null)}function n(r){function a(r){t=d3.zoomTransform(h.node()),scale=t.x,y=r.x0,console.log("source X0 ="+r.x0),x=scale,y=-y*t.k+i/2,d3.select("g").transition().duration(u).attr("transform","translate("+x+","+y+")scale("+scale+")").on("end",(function(){h.call(c.transform,d3.zoomIdentity.translate(x,y).scale(t.k))}))}function e(t,r){return path=`M ${t.y} ${t.x}\n                C ${(t.y+r.y)/2} ${t.x},\n                  ${(t.y+r.y)/2} ${r.x},\n                  ${r.y} ${r.x}`,path}function o(t){t.hasOwnProperty("children")&&(t.children?(t._children=t.children,t.children=null):(t.children=t._children,t._children=null),n(t))}var d=g(f),s=d.descendants(),v=d.descendants().slice(1);let O=[];s.forEach((function(t,r,a){var e;t.hasOwnProperty("children")?(t.y=180*t.depth,t.x=275,r==a.length-1&&emptyArray(O)):0==checkExistElement(O,t.data.operator)?(addElementToArray(O,t.data.operator),t.y=90*t.depth+90*(t.depth-1),t.x=275,r==a.length-1&&emptyArray(O)):(t.y=90*t.depth+90*(t.depth-1),r==a.length-1&&emptyArray(O))}));var w=h.selectAll("g.node").data(s,(function(t){return t.id||(t.id=++p)})).on("mouseover",m.show).on("mouseout",m.hide);let b=[];var k=w.enter().append("g").attr("transform",(function(t){return"translate("+r.y0+","+r.x0+")"})).attr("class",(function(t,r,a){if(t.hasOwnProperty("children"))return"operator node operator("+t.data.name+")";var e,n,o,d,i="undefined";return 0==checkExistElement(b,t.data.operator)?(addElementToArray(b,t.data.operator),i="main",r==a.length-1&&emptyArray(b)):i="undefined",void 0!==t.data.operator&&(n="operator("+t.data.operator+")"),t.hasOwnProperty("id")&&(o="id("+t.data.id+")"),void 0!==t.data.parent_id&&(d="parent_id("+t.data.parent_id+")"),"undefined"!=i&&void 0!==n&&void 0!==o&&void 0!==d?"data node main "+n+" "+o+" "+d:"undefined"!=i&&void 0!==o&&void 0===d&&void 0!==n?"data node main "+n+" "+o:"undefined"===i&&void 0!==o&&void 0===d&&void 0!==n?"data node "+n+" "+o:void 0})).attr("id",(function(t,r,a){return t.hasOwnProperty("children")?"operator "+t.data.name:0==checkExistElement(b,t.data.operator)?(addElementToArray(b,t.data.operator),r==a.length-1&&emptyArray(b),"data-produced-by-"+t.data.operator):(r==a.length-1&&emptyArray(b),"data-produced-by-"+t.data.operator);var e})).attr("display",(function(t){return t.hasOwnProperty("children")?"block":"none"})).on("click",o),E,A=d3.symbol().type(d3.symbolSquare).size(180)(),P,_=d3.symbol().type(d3.symbolDiamond).size(180)(),T,D=d3.symbol().type(d3.symbolCircle).size(180)();k.append("path").style("stroke","black").style("fill","white").attr("d",(function(t){return"input"==t.data.name?D:t.hasOwnProperty("children")&&"input"!=t.name?_:t.hasOwnProperty("children")||"input"==t.name?void 0:D})).style("fill",(function(t){return t._children?"#1c9be3":"#DDDDDD"})),k.append("text").attr("dy","2em").attr("class",(function(t){if(t.hasOwnProperty("children"))return"uk-h6 uk-text-primary"})).attr("x",(function(t){return t.children||t._children?5:13})).attr("text-anchor",(function(t){return t.children||t._children?"end":"start"})).text((function(t){return t.data.name?t.data.name:t.data.word})).attr("display",(function(t){return t.data.children?"block":"none"}));var S=k.merge(w);let C=[];S.transition().duration(u).attr("transform",(function(t){return t.hasOwnProperty("children")?(t.y=180*t.depth,t.x=275,"translate("+t.y+","+t.x+")"):0==checkExistElement(C,t.data.operator)?(addElementToArray(C,t.data.operator),t.y=90*t.depth+90*(t.depth-1),t.x=275,"translate("+t.y+","+t.x+")"):(t.y=90*t.depth+90*(t.depth-1),"translate("+t.y+","+t.x+")");var r})),S.select("path").style("fill",(function(t){return t._children?"lightsteelblue":"#fff"})).attr("cursor","pointer");var z=w.exit().transition().duration(u).attr("transform",(function(t){return"translate("+r.y+","+r.x+")"})).remove();z.select("path").attr("r",1e-6),z.select("text").style("fill-opacity",1e-6);var N=h.selectAll("path.link").data(v,(function(t){return t.id})).style("stroke-width",(function(t){return l(t.data.value)}));let W=[];var j,L;N.enter().insert("path","g").attr("class",(function(t,r,a){return t.hasOwnProperty("children")?"link "+t.data.name:0==checkExistElement(W,t.data.operator)?(addElementToArray(W,t.data.operator),r==a.length-1&&emptyArray(W),"link main link-produced-by-"+t.data.operator):"link link-produced-by-"+t.data.operator;var e})).attr("id",(function(t,r,a){return t.hasOwnProperty("children")?"link "+t.data.name:"link-produced-by-"+t.data.operator})).attr("d",(function(t){var a={x:r.x0,y:r.y0};console.log(r.x0,r.y0);var n=r.y0,o=r.x0;return e(a,a)})).attr("display",(function(t){return t.hasOwnProperty("children")?"block":"none"})).style("stroke-width",(function(t){return l(t.data.value)})).merge(N).transition().duration(u).attr("d",(function(t){return e(t,t.parent)}));var I=N.exit().transition().duration(u).attr("d",(function(t){var a={x:r.x,y:r.y};return e(a,a)})).style("stroke-width",(function(t){return l(t.data.value)})).remove();s.forEach((function(t){var r;t.hasOwnProperty("children")?(t.y=180*t.depth,t.x=275,t.x0=t.x,t.y0=t.y):0==checkExistElement(C,t.data.operator)?(addElementToArray(C,t.data.operator),t.y=90*t.depth+90*(t.depth-1),t.x=275,t.x0=t.x,t.y0=t.y):(t.x0=t.x,t.y0=t.y)})),$("#vs-displayGraph").on("click",(function(){$("svg.vs-svg-for-directed-graph").css("visibility","visible")})),$(".data.node.main").on("click",(function(){var t,r=this.id.split("-")[3];console.log(nameOfOperatorToSearch);var a='*[class*="link-produced-by-'+r+'"]',e='*[id*="data-produced-by-'+r+'"]';$(this).hasClass("selected")?($(this).removeClass("selected"),showContent(e,!1),showContent(a,!1)):($(this).addClass("selected"),showContent(e,!0),showContent(a,!0))})),$(".operator.node").on("click",(function(){var t,r=this.id.split(" ")[1];nameOfOperatorToSearch=r}))}(f=d3.hierarchy(a,(function(t){return t.children}))).x0=i/4,f.y0=0,f.children.forEach(e),n(f)}))}));