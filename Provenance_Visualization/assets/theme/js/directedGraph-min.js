function getDataLinks(t){for(var e="none",r="none",o=0;o<t.length;o++)for(var a=0;a<t[o].length;a++){if(t[o][a].hasOwnProperty("children")){var n=t[o][a].name,s=t[o][a].name+"-output";"false"!=(e=getNeighbourOperatorForDirectedGraph(n,"forward"))&&links.push({source:s,target:e,type:"output_to_operator",strength:.1}),links.push({source:n,target:s,type:"output_to_operator",strength:.1})}if(t[o][a].hasOwnProperty("operator")){nodes.push(t[o][a]);var n=t[o][a].operator,s=t[o][a].operator+"-output",i=t[o][a].parent_id,d=t[o][a].unique_id;links.push({source:s,target:d,parent_id:i,type:"output-group-to-element",strength:.1})}}for(var o=0;o<nameOfAllOperatorForDirectedGraph.length;o++){var n,p=(n=nameOfAllOperatorForDirectedGraph[o])+"-output";if(nodes.push({unique_id:n,id:n,type:"operator_node"}),"input"!=n){var p=n+"-output";nodes.push({unique_id:p,id:p,type:"operator_output"})}if("false"!=(e=getNeighbourOperatorForDirectedGraph(n,"forward"))){if("input"!=n){var p=n+"-output";links.push({source:n,target:p,type:"operator_to_output",strength:.1})}links.push({source:n,target:e,type:"operator_to_operator",strength:.1})}}return[nodes,links,nodes_operator,links_operator]}function getDataForDirectedGraph(t){var e=null;if(t instanceof Array)for(var r=0;r<t.length;r++)e=getDataForDirectedGraph(t[r]);else for(var o in t)"children"==o&&outputOfEachOperatorsForDirectedGraph.push(t[o]),"name"==o&&(console.log(o+": "+t[o]),nameOfAllOperatorForDirectedGraph.push(t[o])),(t[o]instanceof Object||t[o]instanceof Array)&&(e=getDataForDirectedGraph(t[o]));return e}function getNeighbourOperatorForDirectedGraph(t,e){var r="false";if("forward"===e){for(var o=0,a=0,n=0;n<nameOfAllOperatorForDirectedGraph.length;n++)nameOfAllOperatorForDirectedGraph[n]===t&&(o=n);if((o+=1)<nameOfAllOperatorForDirectedGraph.length)return nameOfAllOperatorForDirectedGraph[o];if(t=>nameOfAllOperatorForDirectedGraph.length)return r}if("backward"===e){for(var s=0,n=0;n<nameOfAllOperatorForDirectedGraph.length;n++)nameOfAllOperatorForDirectedGraph[n]===t&&(s=n);return(s-=1)<0?r:nameOfAllOperatorForDirectedGraph[s]}}function getTableDirectedGraphOfGroup(t){$("#vs-table").children().length>0&&$("#vs-table").empty();var e=getDataFromGroup(t),r,o=getTableForDataOfTupel(e,"table_for_directed_graph")[0],a=$('<div class="vs-directed-graph-table-tracing"></div>'),n=$('<div class="vs-directed-graph-container-for-tracing-buttons uk-margin-medium-top uk-flex uk-flex-center"></div>'),s=$('<div class="vs-container-for-tracing-description uk-flex uk-flex-center uk-margin-top"></div>'),i=$('<div class="vs-directed-graph-table-container">'+o.outerHTML+"</div>");a.append(i),$("#vs-table").append(a)}function getTableDirectedGraph(t,e,r){var o=document.getElementById(r);$("#vs-table").children().length>0&&$("#vs-table").empty();var a=getDataFromTupel(t,e),n,s=getTableForDataOfTupel(a,"table_for_directed_graph")[0],i=$('<div class="vs-directed-graph-table-tracing"></div>'),d=$('<div class="vs-directed-graph-container-for-tracing-buttons uk-margin-medium-top uk-flex uk-flex-center"></div>'),p=$('<div class="vs-container-for-tracing-description uk-flex uk-flex-center uk-margin-top"></div>'),l=$('<div class="vs-directed-graph-table-container">'+s.outerHTML+"</div>");i.append(l),$("#vs-table").append(i)}function showContentOfGraph(t,e,r){if("operator_node"==e){var o="#"+t+"-output",a=".output-from-"+t,n="#link-output-to-operator-"+t,s="#link-operator-to-output-"+t+"-output",i="#link-output-to-operator-"+t+"-output",d="#link-operator-to-output-"+t,p=".link-to-output."+t+"-output",l=".link-operator-to-operator."+t,u=".texts-"+t,c=".texts-"+t+"-output";1==r?($(o).hide(),$(a).hide(),$(n).hide(),$(s).hide(),$(d).hide(),$(p).hide(),$(l).show(),$(i).hide(),$(u).hide(),$(c).hide()):($(o).show(),$(a).show(),$(n).show(),$(s).show(),$(d).show(),$(p).show(),$(l).hide(),$(i).show(),$(u).show(),$(c).show())}if("output_group"==e){var h,v=t.split("-")[0],a=".output-from-"+v,p=".link-to-output."+t;console.log("search_id "+v);var l=".link-operator-to-operator."+v,u=".texts-"+v;1==r?($(a).hide(),$(p).hide(),$(l).hide(),$(u).hide()):($(a).show(),$(p).show(),$(u).show())}}function getDataFromGroup(t){var e=[];for(i=0;i<outputOfEachOperator.length;i++)outputOfEachOperator[i].forEach((r=>{r.hasOwnProperty("children")&&r.name===t&&r.children.forEach((t=>{t.hasOwnProperty("children")||e.push(t)}))}));return e}var nameOfOperatorToSearch,dataWithSourceAndTarget=[],links=[],nodes=[],nodes_operator=[],links_operator=[],outputOfEachOperatorsForDirectedGraph=[],nameOfAllOperatorForDirectedGraph=[],colors=["#0A9396","#94D2BD","#E9D8A6","#EE9B00","#CA6702","#BB3E03","#AE2012","#9B2226"],group_by_color=[];$(document).ready((function(){$.getJSON("data/data.json",(function(t){function e(t){return links.reduce((function(e,r){return r.target.id===t.id&&e.push(r.source.id),r.source.id===t.id&&e.push(r.target.id),r.target.id===t.parent_id&&e.push(r.target.id),e}),[t.id])}function r(t,e){return e.target.id===t.id||e.source.id===t.id||e.target.id===t.parent_id}function o(t,e){if("operator_node"===t.type)return"#12206a";if("operator_output"===t.type)return"#1c9be3";if(console.log("firs "+t.operator),void 0!==t.operator){if(0===group_by_color.length){group_by_color.push({operator:t.operator,color:colors[1]});var r=colors[1];const e=colors.indexOf(r);return e>-1&&colors.splice(e,1),r}for(var o=0;o<group_by_color.length;o++){if(group_by_color[o].operator===t.operator)return group_by_color[o].color;if(o+1==group_by_color.length){group_by_color.push({operator:t.operator,color:colors[o]});var r=colors[o];const e=colors.indexOf(r);return e>-1&&colors.splice(e,1),r}}}}function a(t,e){return r(t,e)?"#F3950D":"#E5E5E5"}function n(t,e){return Array.isArray(e)&&e.indexOf(t.id)>-1?"#F3950D":"#001234"}function s(t,e){return void 0!==t.type||Array.isArray(e)&&e.indexOf(t.id)>-1?"block":"none"}function i(t){var r=e(t);_.attr("fill",(function(t){return o(t,r)})),O.attr("fill",(function(t){return n(t,r)})),O.attr("display",(function(t){return s(t,r)})),w.attr("stroke",(function(e){return a(t,e)}))}getDataForDirectedGraph(t),structure=getDataLinks(outputOfEachOperatorsForDirectedGraph),dataWithSourceAndTarget.nodes=structure[0],dataWithSourceAndTarget.links=structure[1],links=structure[1];var d=window.width,p=window.height,l=$("<div class='vs-directed-graph-description-container uk-box-shadow-large uk-margin' ><div class='vs-title uk-padding-small uk-background-primary uk-light'><p class='uk-h4 uk-text-center'>Description</p></div>"),u=$("<div class='vs-directed-graph-description uk-flex uk-padding-small'></div>"),c=$("<div class='vs-directed-graph-description uk-flex uk-padding-small uk-padding-remove-vertical'></div>"),h=$('<div class="vs-color-picker vs-directed-graph-picker"><input type="color" value="#001234" name="vs-checkbox-operator" class="vs-input-operator" id="vs-input-operator"></div><div class="vs-title-color-picker"><span>Operator</span></div>'),v=$('<div class="vs-color-picker vs-directed-graph-picker"><input type="color" value="#1c9be3" name="vs-checkbox-operator-output" class="vs-input-operator-output" id="vs-input-operator"></div><div class="vs-title-color-picker"><span>Output</span></div>');c.append(v),u.append(h),l.append(u),l.append(c);var d=$(".vs-graph").width()+400,p=$(".vs-graph").height()+600,f=$("<svg class='vs-directed-graph' ></div>").attr("width",d).attr("height",p);l.appendTo(".vs-graph"),f.appendTo(".vs-graph");var f=d3.select(".vs-directed-graph"),g=d3.tip().attr("class","d3-tip").offset([-10,0]).html((function(t){var e,r;(t.hasOwnProperty("name")&&(e="<strong>Operator Name:</strong> <span>"+t.data.name+"</span>"),t.hasOwnProperty("children"))?e+="<br /><strong>Number of processed data:</strong> <span>"+t.children.length+"</span>":(e="<strong>Information about Node</strong>",t.hasOwnProperty("operator_number")&&(e+="<br /><strong>Operator Number:</strong> <span>"+t.operator_number+"</span>"),t.hasOwnProperty("operator")&&(e+="<br /><strong>Operator Name:</strong> <span>"+t.operator+"</span>"),t.hasOwnProperty("content")&&(e+="<br /><strong>content:</strong> <span>"+t.content+"</span>"),t.hasOwnProperty("id")&&(e+="<br /><strong>ID:</strong> <span>"+t.id+"</span>"));return e.length>0?e:-1}));f.call(g);var b=$(".vs-graph");f.append("svg:defs").selectAll("marker").data(["end"]).enter().append("svg:marker").attr("id",String).attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",-1.5).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5");var k=d3.forceLink().id((function(t){return t.operator,t.unique_id})).strength((function(t){return t.strength})),m=d3.forceSimulation().force("link",k).force("charge",d3.forceManyBody().strength(-20)).force("center",d3.forceCenter(d/2,p/2)),y=d3.drag().on("start",(function(t){t.fx=t.x,t.fy=t.y})).on("drag",(function(t){m.alphaTarget(.7).restart(),t.fx=d3.event.x,t.fy=d3.event.y})).on("end",(function(t){d3.event.active||m.alphaTarget(0),t.fx=null,t.fy=null})),w=f.selectAll("line").data(links).enter().append("line").attr("stroke-width",2).attr("stroke","rgba(50, 50, 50, 0.2)").attr("marker-end","url(#end)");w.attr("class",(function(t){return t.hasOwnProperty("type")?"output-group-to-element"===t.type||"operator_to_output"===t.type?"links link-to-output "+t.source:"output_to_operator"===t.type?"links link-output-to-operator "+t.source:"operator_to_operator"===t.type?"links link-operator-to-operator "+t.source:void 0:"links"})).attr("id",(function(t){return t.hasOwnProperty("type")?"output-group-to-element"===t.type?"link-output-group-to-element-"+t.source:"operator_to_output"===t.type?"link-operator-to-output-"+t.source:"output_to_operator"===t.type?"link-output-to-operator-"+t.source:"operator_to_operator"===t.type?"link-operator-to-operator-"+t.source:void 0:"links"})).attr("display",(function(t){return t.hasOwnProperty("type")?"block":!t.hasOwnProperty("type")||"output_to_operator"!==t.type&&"operator_to_output"!==t.type?void 0:"block"}));var _=f.selectAll("circle").data(nodes).enter().append("circle").attr("r",10).attr("fill",o).call(y).on("click",i).on("mouseover",g.show).on("mouseout",g.hide);_.attr("class",(function(t){return t.hasOwnProperty("operator")?"nodes output-node output-from-"+t.operator:t.hasOwnProperty("type")?"operator_output"===t.type?"nodes group-output-node output-group-from-"+t.id:"operator_node"===t.type?"nodes operator-node operator-node-"+t.id:void 0:"nodes"})).attr("id",(function(t){return t.hasOwnProperty("operator")?"operator("+t.operator+") id("+t.id+") uniqueId("+t.unique_id+") parentId("+t.parent_id+")":t.hasOwnProperty("type")?"operator_output"===t.type||"operator_node"===t.type?t.id:void 0:"nodes"})).attr("display",(function(t){return t.hasOwnProperty("operator")||t.hasOwnProperty("type")&&"operator_output"===t.type?"block":void 0}));var O=f.append("g").selectAll("text").data(nodes).enter().append("text").text((function(t){return"operator_node"===t.type||"operator_output"===t.type?t.id:t.content})).attr("font-size",(function(t){return"operator_node"===t.type?40:15})).attr("dx",15).attr("dy",4);O.attr("display",(function(t){return t.hasOwnProperty("operator")?"none":t.hasOwnProperty("type")?"block":void 0})).attr("class",(function(t){return t.hasOwnProperty("operator")?"texts texts-"+t.operator:t.hasOwnProperty("type")&&"operator_output"===t.type?"texts texts-"+t.id:"texts"})),m.nodes(nodes).on("tick",(()=>{_.attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})),O.attr("x",(function(t){return t.x})).attr("y",(function(t){return t.y})),w.attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y}))})),m.force("link").links(links),$(".operator-node").on("dblclick",(function(t){var e=$(this).attr("id");$(this).hasClass("selected")?($(this).removeClass("selected"),showContentOfGraph(e,"operator_node",!1)):($(this).addClass("selected"),showContentOfGraph(e,"operator_node",!0))})),$(".group-output-node").on("dblclick",(function(t){var e=$(this).attr("id");$(this).hasClass("selected")?($(this).removeClass("selected"),showContentOfGraph(e,"output_group",!1)):($(this).addClass("selected"),showContentOfGraph(e,"output_group",!0))})),$(".output-node").on("click",(function(t){var e,r=$(this).attr("id").split(" "),o,a=r[0].replace("operator(","").replace(")",""),n,s=r[1].replace("id(","").replace(")",""),i,d=r[3].replace("parentId(","").replace(")",""),p;getTableDirectedGraph(s,a,"vs-table");var l=function(t,e){document.getElementsByClassName(t).length?e():setTimeout((function(){l(t,e)}),100)},u="vs-table-for-directed-graph";l(u,(function(){var t=document.getElementsByClassName(u),e="#"+$(t).attr("id");$(e).DataTable({scrollY:"50vh",scrollCollapse:!0,paging:!0}),$(".dataTables_scrollHeadInner table").removeClass("vs-table-for-directed-graph"),$(".dataTables_scrollHeadInner table").addClass("vs-get-header"),$(".vs-table-for-directed-graph tbody tr").on("click",(function(){if($(this).hasClass("vs-row-was-selected"))alert("this row was already selected before, please check the 'your selected data' area");else{modal_table=createModal(modal_for_table);var t=modal_table.attr("id"),e="vs-panel-id-"+t,r=$("<span class='vs-close vs-close-modal' onClick=closeModal('"+t+"'); >&times;</span>"),o=$('<div class="vs-panel" id="'+e+'"></div>'),a=$('<div class="vs-modal-for-table-container uk-box-shadow-small">');$(this).addClass("vs-row-was-selected"),$(this).attr("id",t);var n=$('<table class="uk-table uk-table-responsive uk-table-divider vs-modal-table""></table>'),s=$("<thead></thead>"),i=$("<tr></tr>"),d=".vs-get-header thead tr",p=findPositionOFId(d),l=findPositionOfOperator(d);$(".vs-get-header thead tr").find("th").each((function(){i.append("<th>"+$(this).text()+"</th>")})),s.append(i),n.append(s);var u=$("<tbody></tbody>"),c=$("<tr></tr>"),h=$('<div class="vs-modal-for-tracing-container  uk-margin-top"></div>'),v=$('<div class="vs-modal-for-tracing-buttons uk-flex uk-flex-center"></div>'),f=$('<div class="vs-container-for-tracing-description uk-flex uk-flex-center uk-margin-top"></div>'),g=p.id_position,b=p.parent_id_position,k=l.operator_position;if(2===Object.keys(p).length||1===Object.keys(p).length){var m,y,w=$(this).find("td").eq(b).text(),_=$(this).find("td").eq(g).text(),O=$(this).find("td").eq(k).text(),x=getNeighbourOperator(O,"forward"),C;"false"!=getNeighbourOperator(O,"backward")&&(m=$('<button class="uk-button uk-button-secondary uk-margin-right vs-button-backward-tracing" id="vs-button-backward-tracing" onClick=backwardTracing('+w+',"'+O+'"); >Backward Tracing</button>'),v.append(m)),"false"!=x&&(y=$('<button class="uk-button uk-button-secondary uk-margin-right vs-button-forward-tracing" id="vs-button-forward-tracing" onClick=forwardTracing('+_+',"'+O+'"); >Forward Tracing</button>'),v.append(y)),h.append(v),h.append(f)}else(Object.keys(p).length>2||0==Object.keys(p).length)&&h.append("<p>Something went wrong, please check the data format</p>");$(this).find("td").each((function(){c.append("<td>"+$(this).text()+"</td>")})),o.append(r),u.append(c),n.append(u);var D=$('<button class="uk-button uk-button-secondary  vs-button-save-rows" id="vs-button-save-rows" onClick=saveTable("vs-modal-table"); >Save</button>');v.append(D),a.append(n),o.append(a),o.append(h),modal_table.append(o),$("#vs-visualization").append(modal),$("#content").addClass("vs-overlay"),$(".vs-modal").css("display","block"),$(".vs-modal").draggable(),adaptHeightForCss(e,t)}}))}))})),$(".group-output-node").on("click",(function(t){var e,r,o="vs-table";getTableDirectedGraphOfGroup($(this).attr("id").replace("-output",""));var a=function(t,e){document.getElementsByClassName(t).length?e():setTimeout((function(){a(t,e)}),100)},n="vs-table-for-directed-graph";a(n,(function(){var t=document.getElementsByClassName(n),e="#"+$(t).attr("id");$(e).DataTable({scrollY:"50vh",scrollCollapse:!0,paging:!0}),$(".dataTables_scrollHeadInner table").removeClass("vs-table-for-directed-graph"),$(".dataTables_scrollHeadInner table").addClass("vs-get-header"),$(".vs-table-for-directed-graph tbody tr").on("click",(function(){if($(this).hasClass("vs-row-was-selected"))alert("this row was already selected before, please check the 'your selected data' area");else{modal_table=createModal(modal_for_table);var t=modal_table.attr("id"),e="vs-panel-id-"+t,r=$("<span class='vs-close vs-close-modal' onClick=closeModal('"+t+"'); >&times;</span>"),o=$('<div class="vs-panel" id="'+e+'"></div>'),a=$('<div class="vs-modal-for-table-container uk-box-shadow-small">');$(this).addClass("vs-row-was-selected"),$(this).attr("id",t);var n=$('<table class="uk-table uk-table-responsive uk-table-divider vs-modal-table""></table>'),s=$("<thead></thead>"),i=$("<tr></tr>"),d=".vs-get-header thead tr",p=findPositionOFId(d),l=findPositionOfOperator(d);$(".vs-get-header thead tr").find("th").each((function(){i.append("<th>"+$(this).text()+"</th>")})),s.append(i),n.append(s);var u=$("<tbody></tbody>"),c=$("<tr></tr>"),h=$('<div class="vs-modal-for-tracing-container  uk-margin-top"></div>'),v=$('<div class="vs-modal-for-tracing-buttons uk-flex uk-flex-center"></div>'),f=$('<div class="vs-container-for-tracing-description uk-flex uk-flex-center uk-margin-top"></div>'),g=p.id_position,b=p.parent_id_position,k=l.operator_position;if(2===Object.keys(p).length||1===Object.keys(p).length){var m,y,w=$(this).find("td").eq(b).text(),_=$(this).find("td").eq(g).text(),O=$(this).find("td").eq(k).text(),x=getNeighbourOperator(O,"forward"),C;"false"!=getNeighbourOperator(O,"backward")&&(m=$('<button class="uk-button uk-button-secondary uk-margin-right vs-button-backward-tracing" id="vs-button-backward-tracing" onClick=backwardTracing('+w+',"'+O+'"); >Backward Tracing</button>'),v.append(m)),"false"!=x&&(y=$('<button class="uk-button uk-button-secondary uk-margin-right vs-button-forward-tracing" id="vs-button-forward-tracing" onClick=forwardTracing('+_+',"'+O+'"); >Forward Tracing</button>'),v.append(y)),h.append(v),h.append(f)}else(Object.keys(p).length>2||0==Object.keys(p).length)&&h.append("<p>Something went wrong, please check the data format</p>");$(this).find("td").each((function(){c.append("<td>"+$(this).text()+"</td>")})),o.append(r),u.append(c),n.append(u);var D=$('<button class="uk-button uk-button-secondary uk-margin-right vs-button-save-rows" id="vs-button-save-rows" onClick=saveTable(1); >Save</button>');v.append(D),a.append(n),o.append(a),o.append(h),modal_table.append(o),$("#vs-visualization").append(modal),$("#content").addClass("vs-overlay"),$(".vs-modal").css("display","block"),$(".vs-modal").draggable(),adaptHeightForCss(e,t)}var T=function(t,e){document.getElementsByClassName(t).length?e():setTimeout((function(){T(t,e)}),100)},F;T("vs-modal-table",(function(){$(".vs-modal-table tbody tr").on("click",(function(){$(this).hasClass("vs-selected-row")?$(this).removeClass("vs-selected-row"):$(this).addClass("vs-selected-row")}))}))}))}))}))}));var t=function(e,r){document.getElementsByClassName(e).length?r():setTimeout((function(){t(e,r)}),100)},e;t("vs-modal-table",(function(){$(".vs-modal-table tbody tr").on("click",(function(){$(this).hasClass("vs-selected-row")?$(this).removeClass("vs-selected-row"):$(this).addClass("vs-selected-row")}))}))}));